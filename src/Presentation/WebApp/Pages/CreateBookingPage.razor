@page "/bookings/new"
@attribute [Authorize]
@inject IBookingService BookingService
@inject NavigationManager NavigationManager
@inject ISnackbar Snackbar

<h3>Nowa Rezerwacja</h3>

<BookingForm Model="newBooking" OnValidSubmit="HandleCreateBooking" ButtonText="Utwórz Rezerwację" />

@code {
    private BookingRequestDto newBooking = new();

    private async Task HandleCreateBooking()
    {
        // TODO: Na razie hardkodujemy ID zasobu. Docelowo będzie wybierany z listy.
        newBooking.ResourceId = Guid.Parse("TUTAJ_WKLEJ_ID_ZASOBU_Z_BAZY_DANYCH"); // <--- WAŻNE

        var result = await BookingService.CreateBookingAsync(newBooking);
        if (result != null)
        {
            Snackbar.Add("Rezerwacja została utworzona!", Severity.Success);
            NavigationManager.NavigateTo("/my-reservations");
        }
        else
        {
            Snackbar.Add("Nie udało się utworzyć rezerwacji (konflikt terminów?).", Severity.Error);
        }
    }
}